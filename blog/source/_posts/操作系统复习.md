---
title: 操作系统复习.md
toc: true
date: 2024-05-30 10:29:43
tags: 笔记
categories: 2024学习笔记
excerpt: 这是一篇操作系统课程预习笔记
---
## 操作系统的整体概念

用户接口：提供操作界面

存储管理：分配内存空间

设备管理：分配设备资源

CPU：计算、处理

文件管理：创建、维护、访问目录、文件

调度：管理整个流程

## 第 1 章：绪论

### 操作系统概念

* 操作系统承担**与硬件相关、与应用无关的基本工作**，并解决这些基本工作中的效率和安全问题，为使用户能方便、高效、安全地使用计算机，而从最底层统一提供**通用**的帮助和管理。
* 现代操作系统的客户/服务器结构下，OS分为：运行在**用户态**并以客户/服务器方式活动的进程，运行在**核心态**的内核

从5个方面考察

* 科普观点：操作系统是计算机系统的管理指挥机构和控制中心。
* 功能观点：操作系统是计算机资源管理系统，负责对计算机的全部软、硬件资源进行分配、控制、调度和回收。
* 用户观点：操作系统是用户使用计算机的一个界面。
* 管理员观点：操作系统是计算机工作流程得以自动高效运行的组织者，系统软硬件资源合理协调的管理者。
* 软件观点：操作系统是由程序和数据集合组成的大型系统软件。

### 操作系统的发展历史

* 手工

  * 用户：用户既是程序员，又是操作员；用户是计算机专业人员；
  * 编程语言：为机器语言；
  * 输入输出：纸带或卡片；
* 批处理

  * 联机批处理：I/O设备与主机直接连接

    1. 用户将程序写在纸上
    2. 将作业穿孔成卡片，再将卡片盒交给操作员
    3. 操作员有选择地把若干作业合成一批，通过输入设备（纸带输入机或读卡机）输入
    4. 监督程序读入一个作业
    5. 从输入设备调入，编译、连接、运行程序
    6. 返回4，再读入一个作业，直到一批作业完成
    7. 返回3，处理下一批
  * 脱机批处理：增加一台不与主机直接相连而专门与I/O设备交换信息的卫星机
* 多道程序

  * 单道运行：每次只调一个用户作业程序进入内存并运行
  * 多道程序：进入系统的几道相互独立的程序均在运行
  * 相关技术问题

    * 处理机管理问题：如何分配，使CPU满足要求
    * 内存管理问题：为每道程序分配内存空间
    * I/O设备管理问题：如何分配I/O设备
    * 文件管理问题：如何组织程序和数据
    * 作业管理问题：如何组织作业
* 分时

  * 分时是指多个用户分享使用同一台计算机，分时共享硬件和软件资源。
* 实时

  * 用于工业过程控制、军事实时控制、金融等领域，包括实时控制、实时信息处理系统资源

目前的操作系统，通常具有分时、实时和批处理功能，又称作通用操作系统。可适用于计算、事务处理等多种领域，能运行在多种硬件平台上，如UNIX系统、WindowsNT等。

### 操作系统的基本类型

批处理、分时、实时、个人计算机、网络、分布式、嵌入式

* 实时操作系统主要用于过程控制、事务处理等有实时要求的领域，其主要特征是**实时性**和**可靠性**。
* 网络操作系统
  * 网络是一个互连的计算机系统群体，系统互连要通过通信设施实现
  * 其中的计算机是自治的，每台计算机均有自己的操作系统，各自独立工作，在网络协议控制下协同工作
* 分布式操作系统
  * 集中式计算机系统：处理和控制能力都高度集中在一台计算机上，所有任务均由它完成。
  * 分布式计算机系统：由多台分散的计算机经互联网络连接而成的系统。
  * 管理分布式计算机系统的操作系统称为分布式操作系统。

### 操作系统的功能

处理机管理、存储管理、设备管理、文件管理、用户接口

### 操作系统的特征

并发、共享、虚拟、异步

并发和并行

* 并发：指多个事件在同一时间段内发生。微观串行
* 并行（parallel）: 是指在同一时刻发生。微观并行

共享

* 多个进程共享有限的计算机系统资源。操作系统要对系统资源进行合理分配和使用。资源在一个时间段内交替被多个进程所用

虚拟

* 一个物理实体映射为若干个对应的逻辑实体——分时或分空间

异步

* 也称**不确定性**：指进程的执行顺序和执行时间的不确定性

### 现代操作系统特征

微内核、多线程、对称多处理、分布式、面向对象

### 习题

1、在下列操作系统中，(A)不具有用户独立性？

A. 批处理系统

B. 分时系统

C. 实时系统

D.以上三种系统都具有

2、在下列操作系统中，(B)交互性最强？

A. 单道批处理

B. 分时系统

C. 实时系统

D.多道批处理

3、在下列操作系统中，(C)及时性最强？

A. 单道批处理

B. 分时系统

C. 实时系统

D.多道批处理

4、在下列操作系统中，(C)不具有宏观上的同时执行性？

A. 实时系统

B.分时系统

C. 单道批处理

D.多道批处理

![png](/img/QQ截图20240602174623.png)

## 第 2 章：用户接口与作业管理

内存和外存、就绪状态、等待状态和完成状态

### 作业管理

#### **作业基本概念**

* 作业（用户角度、系统角度）
  * 系统角度：作业= 程序+数据（作业体）+ 作业说明书（作业控制语言）
    * 在批处理系统中，作业是抢占内存的基本单位，即以作业为单位将程序和数据调入内存。
  * 用户角度：在一次应用业务处理过程中，从输入开始到输出结束，用户要求计算机所作的有关该次业务处理的全部工作称为一个作业。
* 作业组织（作业、说明书、控制语言）
  * **作业说明书**：体现用户的控制意图
    包括作业基本情况、作业控制、作业资源要求的描述
    * 作业基本情况：用户名、作业名、编程语言、最大处理时间等
    * 作业控制描述：作业控制方式（脱机/联机）、作业步的操作顺序、作业执行出错处理
    * 作业资源要求描述：处理时间、优先级、内存空间、外设类型和数量、库函数或实用程序等
  * **作业控制语言**：用户用于描述批处理作业处理过程控制意图的一种特殊程序
    书写作业说明书的语言称为作业控制语言（JCL）

#### **作业的建立**

* 作业的输入、作业控制块的建立
* 作业输入方式

  * 联机输入、脱机输入、直接耦合、Spooling、网络
* 作业控制块的建立

### **用户接口**

* 程序级接口（系统调用）、操作级接口、图形用户接口

#### **系统调用（类、功能、实现过程）**

* 系统调用是操作系统提供给软件开发人员的唯一接口，开发人员可利用它使用系统功能。OS核心中都有一组实现系统功能的过程（子程序），系统调用就是对上述过程的调用。

#### 程序调用的功能

* 设备管理：设备的读写和控制
* 文件管理：文件读写和文件控制
* 进程控制：创建、中止、暂停等控制
* 进程通信：进程之间传递消息或信号
* 存储管理：内存的申请和释放
* 系统管理：设置和读取时间、读取
* 通过系统调用接口也可使用系统命令

  * C语言里的system()函数可调用shell来完成命令
  * 如 UNIX系统： system("cp -r doc /tmp")

#### 系统调用与普通过程调用

* 相同点
  * 改变指令流程
  * 重复执行和公用
  * 改变指令流程后需要返回原处
* 不同点
  * 执行状态不同：调用和返回经历了不同的系统状态。通常核心和应用程序的代码分别运行在CPU的不同的状态下（系统态/核心态/管态和用户态/目态），所用地址空间也不同――核心的代码可以直接访问应用进程的地址空间，反之不然。（系统调用和应用程序代码在执行时，它们运行在 CPU 的不同状态下，并使用不同的地址空间。）
  * 进入方式不同：利用int或trap指令进行系统调用；利用call或jmp指令进入普通的过程调用；
  * 返回方式：采用抢先式调度的系统，在系统调用返回时，要对系统中所有要求运行的进程进行优先级分析，并进行重新调度的检查――是否有更高优先级的任务就绪（创建或唤醒）

## 第 3 章：进程管理

为了描述程序在并发执行时对系统资源的共享，需要一个描述程序执行时动态特征的概念，这就是进程。

### 概述

#### 程序的执行

程序的执行有两种方式：顺序执行和并发执行。

**顺序执行**

具有独立功能的程序独占CPU直至得到最终结果的过程。

顺序执行是单道批处理系统的执行方式，也用于简单的单片机系统。

**顺序执行的特征**

* 顺序性：按照程序结构所指定的次序（可能有分支或循环）
* 封闭性：独占全部资源，计算机的状态只由该程序的控制逻辑所决定
* 可再现性：初始条件相同则结果相同。

**并发执行**

程序的并发执行是指一组在逻辑上互相独立的程序或程序段在执行时间上客观上互相重叠，即一个程序或程序段的执行尚未结束，另一个程序（段）的执行已经开始的执行方式。

* 并发：在一段时间（段）内的同时并行
* 并行：在同一物理时刻的同时

#### 进程进程的组成（程序+数据+PCB）

一个具有一定独立功能的程序在一个数据集合上的一次动态执行过程。

它对应虚拟处理机、虚拟存储器和虚拟外设等资源的分配和回收；

反映系统中程序执行的并发性、随机性和资源共享；

引入多进程，提高了对硬件资源的利用率，但又带来额外的空间和时间开销，增加了OS 的复杂性。

在计算机中处于运行状态的任何一个程序都是一个进程，一个进程拥有内存、CPU时间等一系列资源。

**进程的特征**

* 动态性：
  * 进程对应程序的执行
  * 进程是动态产生：创建→运行→消亡
  * 进程在其生命周期内，在三种基本状态之间转换
* 独立性：各进程的地址空间相互独立，除非采用进程间通信手段
* 并发性：任何进程都可以同其他进程一起向前推进
* 异步性：每个进程都以其相对独立的不可预知的速度向前推进
* 结构化：进程 = 代码段 + 数据段 + PCB

**进程与程序的区别**

* 进程与程序的组成不同：进程的组成包括程序、数据和进程控制块（即进程状态信息）。
* 进程与程序的对应关系：通过多次执行，一个程序可对应多个进程；通过调用关系，一个进程可包括多个程序。
* 进程具有并行特征，程序没有。进程具有独立性和异步性
* 进程是竞争计算机资源的基本单位。

#### 进程控制块PCB（作用、所包含信息）

* 进程控制块是由OS维护的用来记录进程相关信息和管理进程而设置的一个专门的数据结构，包含了进程的描述信息、控制信息和资源信息以及现场保护区。
* PCB是进程动态特性的集中反映
  * 系统通过PCB感知进程的存在，PCB随进程的创建而填写，随进程的撤消而释放
  * 系统通过PCB中所包含的各项变量的变化，掌握进程的状态以达到控制进程活动的目的
* PCB结构的全部或部分常驻内存；
* 系统利用PCB来控制和管理进程，所以PCB是系统感知进程存在的唯一标志
* 进程与PCB是一一对应的

**进程描述信息**

* 进程标识符 (process ID)，唯一，通常是一个整数
* 进程名，通常基于可执行文件名
* 用户标识符 (user ID)
* 进程组关系 (process group)

**进程控制信息**

* 当前状态
* 优先级 (priority)
* 代码执行入口地址
* 程序的外存地址
* 运行统计信息（执行时间、页面调度）
* 进程间同步和通信，阻塞原因

**资源占用信息**

虚拟地址空间的现状、打开文件列表

**CPU现场保护结构**

寄存器值（通用、程序计数器PC、状态PSW，地址包括栈指针）

#### 进程上下文（用户级、寄存器级、系统级）

进程上下文是对进程执行活动全过程的静态描述。进程上下文由进程的用户地址空间内容、硬件寄存器内容及与该进程相关的核心数据结构组成（正文段、数据集、堆栈）。

* 用户级上下文：进程的用户地址空间（包括用户栈各层次），包括用户正文段、用户数据段和用户栈；
* 寄存器级上下文：程序寄存器、处理机状态寄存器、栈指针、通用寄存器的值；
* 系统级上下文：
  * 静态部分（PCB和资源表格）
  * 动态部分：核心栈（核心过程的栈结构，不同进程在调用相同核心过程时有不同核心栈）

![img](img//QQ截图20240620164222.png)

#### PCB的组织方式（链表、索引表）

PCB表：
系统把所有PCB组织在一起，并把它们放在内存的固定区域，就构成了 PCB表，PCB表的大小决定了系统中最多可同时存在的进程个数，称为系统的并发度。

**链表**

* 同一状态的进程其PCB成一链表，多个状态对应多个不同的链表
* 各状态的进程形成不同的链表：就绪链表、阻塞链表

![img](/img/QQ截图20240620164538.png)

**索引表**

* 同一状态的进程归入一个index表（由index指向PCB），多个状态对应多个不同的index表
* 各状态的进程形成不同的索引表：就绪索引表、阻塞索引表

![img](/img/QQ截图20240620164604.png)


### 进程的状态及转换

#### 核心态和用户态

进程的执行状态可分为用户执行状态和系统执行状态
**用户执行状态**

又称用户态，进程的用户程序段执行时，该程序处于用户态。用户态时不可直接访问受保护的OS代码；
**系统执行状态**

又称系统态，核心态，进程的系统程序执行时，该进程处于系统态。核心态时可以执行OS代码，可以访问全部进程空间。

**划分用户态和系统态的原因**
把用户程序和系统程序分开，以利程序的保护和共享

但增加了系统复杂度和系统开销

进程

#### 内存中3种基本状态（转换、条件）

* 就绪态（Ready） ：一个进程已经具备运行条件，但由于无CPU暂时不能运行的状态（当调度给其CPU时，立即可以运行。位于“就绪队列”中
* 执行态（Running） ：进程占有了包括CPU在内的全部资源，并在CPU上运行
* 等待态（Blocked） ：阻塞态、挂起态、封锁态、冻结态、睡眠态。指进程因等待某种事件的发生而暂时不能运行的状态（即使CPU空闲，该进程也不可运行）。处于等待态的进程位于等待队列中

**相互转化**

在进程运行过程中，由于进程自身进展情况及外界环境的变化，这三种基本状态可以依据一定的条件相互转换

* 就绪→运行：调度程序选择一个新的进程运行
* 运行→就绪：
  * 运行进程用完了时间片
  * 运行进程被中断，因为一高优先级进程处于就绪状态
* 运行→等待：当一进程等待某一事件的发生时，如
  * 请求系统服务
  * 无新工作可做
* 等待→就绪：当所等待的事件发生时

#### 其他状态

**创建状态：创建( 新new)状态**

* OS 已完成为创建一进程所必要的工作

  * 已构造了进程标识
  * 已创建了管理进程所需的表格
* 但还没有允许执行该进程 (尚未同意)

  * 因为资源有限，OS所需的关于该进程的信息保存在主存中的进程表中，但进程自身还未进入主存，也没有为与这个程相关的数据分配空间，程序保留在辅存中。
* **导致进程创建的原因**

  * 批处理环境中，选择一新作业即将进入内存执行
  * 交互环境中，新用户登录到系统
  * 操作系统因提供一项服务而创建。如：用户请求打印一个文件，OS可创建严格管理打印的进程，使请求进程可继续执行，与完成打印任务的时间无关
  * 由现有进程生成，父进程----子进程

**终止状态（Exit）**

* 终止后进程移入该状态
* 它不再有执行资格
* 表格和其它信息暂时保留
* 实用程序为了分析性能和利用率，可能要提取程序的历史信息
* **导致终止进程的原因**

  * 含一个HALT指令或用于终止的OS显式服务调用
  * 分时系统中，用户的行为可指示终止，如：用户退出系统或关闭自己的终端，该用户的进程将被终止
  * PC机环境中，用户结束一应用程序
  * 出现某些错误时，如，I/O失败，无效指令等
  * 父进程可请求它的某个子进程终止
  * 父进程终止，OS自动终止所有后代进程

**挂起状态**

* 把一个进程从内存转到外存

#### 扩展：3状态、5状态、7状态（状态、转换、条件、数据结构等）

### 进程控制

#### 功能、原语、UNIX进程管理

多道程序设计
进程基本概念
进程同步互斥
进程间通信
进程调度
死锁

## 第 4 章：处理机调度

## 第 5 章：存储管理

存储体系
存储管理任务
段式存储管理
页式存储管理
段页式
虚拟存储技术
交换技术

## 第 6 章：文件管理

主要内容：

文件基本概念
磁盘结构
文件目录
文件系统使用
文件系统安全
外存空间管理

### 引言

### 文件管理的目的

### 基本概念（文件、目录、文件分类）

**文件**

文件是具有文件名的一组相关元素的有序集合。文件名是文件的标识符号。相关字符流的集合（无结构文件）或相关记录的集合（有结构文件）。文件包括两部分：

* 文件体：文件本身的信息；
* 文件说明：文件存储和管理信息；如：文件名、文件内部标识、文件存储地址、访问权限、访问时间等
  * 文件的属性：包括文件类型、文件长度、文件的物理位置、文件的建立时间

文件类型：

* 按用途分：系统文件、用户文件、库文件
* 按数据形式分：源文件、目标文件、可执行文件
* 按存取控制属性分：只执行文件、只读文件、读写文件
* 按组织形式和处理方式分
  * 普通文件：ASCII码或二进制码组成的字符文件
  * 目录文件：由文件目录组成
  * 特殊文件：系统中各类I/O设备

**文件分类**

* 按存放时限分类：根据系统保留文件的时间：临时文件、永久文件和档案文件。
* 按设备类型分类：根据文件存储介质的设备类型：磁盘文件、磁带文件、卡片文件和打印文件等。
* 按文件的组织结构分类:
  * 文件的逻辑结构：从用户观点出发观察到的文件组织
  * 文件的物理结构：文件的存储结构，即文件在外存的存储组织形式。涉及存储介质、外存分配方式

**目录**

### 文件系统的结构和功能元素

### 文件的组织

文件的组织

* 逻辑结构
* 物理结构

### 文件目录

* 内容
* 结构
* 别名的实现（硬连接、符号连接）

### 文件目录的访问和使用

* 文件的访问
* 文件的控制
* 目录管理
* 伪文件

### 文件共享和访问控制

* 存取控制
* 共享：一个文件可以让指定的某些用户共同使用

  * 节省空间
  * 免除系统复制文件的重复性工作
  * 减少访问外存次数（文件复制增加外存访问次数)
  * 保证信息一致性

  **静态文件共享：**

  基于基本目录共享法

      设置一个基本文件目录，每个目录相对应一个文件，记录文件的唯一标识符ID、文件的存取控制管理信息、文件的物理地址等。

  基于符号链共享方式

      为使目录B能共享C的一个文件F，由系统创建一个Link类型的新文件，也取名为F，并将F写入B的目录中，以实现B的目录与文件F的链接。新文件中只包含被链接文件F的路径名。

  **动态文件共享：**

  当多个用户同时打开某一文件对其访问时，在内存中建立打开文件结构：进程打开文件表、系统打开文件表、文件的内存索引节点。

  **共享语义：**

  规定了一个用户对共享数据的修改何时对另一个用户可见，这种语义通常由文件系统功能决定
* 访问权限

  * 用户范围类型：指定用户、用户组、任意用户
  * 访问类型和用户范围的组合
    * 访问矩阵：矩阵的一维是每个目录和文件，另一维是用户范围，每个元素是允许的访问方式
    * 存取控制表：以文件为单位，把用户按某种关系划分为若干组，同时规定每组的存取权限。实现时，该表放在文件说明中，打开文件时，被复制了内存中；效率高
* 并发访问
* 安全、可靠性

### 文件存储空间管理

* 存储设备
* 空间分配
* 磁盘空闲空间管理
* 文件卷

### 文件系统层次模型

## 第 7 章：设备管理

设备分类
设备独立性
I/O软件组成
设备分配
虚设备技术
缓冲技术
通道技术
磁盘调度

## 附录：英文缩写对应

主文件目录：MFD

用户文件目录：UFD

文件控制块：FCB

基本文件目录：BFD

标识符：ID

空闲文件目录：FFD

符号文件目录：SFD
